---
title: 陶哲轩实分析 (下)
description: 浮云游子意, 落日故人情. 挥手自兹去, 萧萧班马鸣.
date: 2025-04-03
---

- [陶哲轩实分析](https://book.douban.com/subject/30227556/)
  - [Partial Lean formalization of Analysis I](https://github.com/teorth/analysis)

### 傅里叶级数

- 尽管傅里叶级数理论与幂级数理论存在一些相似的地方,
  但两者之间仍然存在一些重要的区别. 例如,
  傅里叶级数的收敛通常都不是一致的 (也就是说, 它不依
  $$ L^∞ $$
  度量收敛), 但它依另一种不同的度量:
  $$ L^2 $$
  度量收敛.
  - 另外, 在该理论中我们将会大量使用复数,
    但幂级数只是稍微涉及了一点复数.

- 如果函数
  $$ f $$
  是
  $$ 1 $$
  周期的, 那么对于任意的
  $$ k \in Z $$
  都有
  $$ f(x + k) = f(x) $$.
  - 因此,
    $$ 1 $$
    周期的函数有时也被称作
    $$ Z $$
    周期的 (而且
    $$ L $$
    周期的函数被称为是
    $$ LZ $$
    周期的).

- 为简单起见, 从现在开始我们只研究
  $$ Z $$
  周期函数.
  - 注意, 为了能完全了解
    $$ Z $$
    周期函数
    $$ f: R \to C $$,
    我们只需要了解它在区间
    $$ [0, 1) $$
    上的取值就行了, 因为这将确定
    $$ f $$
    在任意一点处的取值.

- 连续的
  $$ Z $$
  周期复值函数的空间记作
  $$ C(R / Z; C) $$.
  (记号
  $$ R / Z $$
  来源于代数学, 它表示加法群
  $$ R $$
  关于加法群
  $$ Z $$
  的商群.)
  - 这里的"连续"是指在
    $$ R $$
    中的任意一点处都连续. 只在某个区间, 如
    $$ [0, 1] $$
    上连续是不够的, 因为
    $$ 1 $$
    点 (或其他任意一个整数点)
    处的左极限和右极限可能不同而产生间断.

- 引理
  $$ C(R / Z; C) $$
  的基本性质
  - (a) (__有界性__) 如果
    $$ f \in C(R / Z; C) $$,
    那么
    $$ f $$
    是有界的 (即存在一个实数
    $$ M > 0 $$,
    使得对于所有的
    $$ x \in R $$
    都有
    $$ | f(x) | ≤ M $$).
  - (b) (__向量空间和代数性质__) 如果
    $$ f, g \in C(R / Z; C) $$,
    那么函数
    $$ f + g $$,
    $$ f - g $$
    和
    $$ fg $$
    也都属于
    $$ C(R / Z; C) $$.
    另外, 如果
    $$ c $$
    是任意一个复数, 那么函数
    $$ cf $$
    也在
    $$ C(R / Z; C) $$
    中.
  - (c) (__一致极限下的封闭性__) 设
    $$ (f_n)_{n = 1}^{\infty} $$
    是
    $$ C(R / Z; C) $$
    中的函数序列, 如果该序列一致收敛于函数
    $$ f: R \to C $$,
    那么
    $$ f $$
    也属于
    $$ C(R / Z; C) $$.

- 定义 (__内积__) 如果
  $$ f, g \in C(R / Z; C) $$,
  那么我们把`内积`
  $$ \langle f, g \rangle $$
  定义为
  - $$ \langle f, g \rangle = \int_{[0, 1]} f(x) \overline{g(x)} dx $$

- 引理 设
  $$ f, g, h \in C(R / Z; C) $$.
  - (a) (__厄米性质__)
    $$ \langle g, f \rangle = \overline{\langle f, g \rangle} $$.
  - (b) (__正性__)
    $$ \langle f, f \rangle ≥ 0 $$.
    更进一步地,
    $$ \langle f, f \rangle = 0 $$
    当且仅当
    $$ f = 0 $$
    (也就是说, 对于所有的
    $$ x \in R $$,
    都有
    $$ f(x) = 0 $$).
  - (c) (__关于第一个变量的线性性质__)
    $$
      \langle f + g, h \rangle =
      \langle f, h \rangle +
      \langle g, h \rangle
    $$.
    对于任意的复数
    $$ c $$,
    有
    $$ \langle cf, g \rangle = c \langle f, g \rangle $$.
  - (d) (__关于第二个变量的反线性性质__)
    $$
      \langle f, g + h \rangle =
      \langle f, g \rangle +
      \langle f, h \rangle
    $$.
    对于任意的复数
    $$ c $$,
    有
    $$ \langle f, cg \rangle = \overline{c} \langle f, g \rangle $$.

- 注:
  $$ L^2 $$
  度量的性状不如
  $$ L^∞ $$
  度量的好. 例如, 在
  $$ L^2 $$
  度量下的空间
  $$ C(R / Z; C) $$
  并不是完备的, 但该空间在
  $$ L^∞ $$
  度量下是完备的.

- 定义 (__特征__) 对于每一个整数
  $$ n $$,
  令
  $$ e_n \in C(R / Z; C) $$
  表示函数
  - $$ e_n (x) := e^{2 \pi i n x} $$
  - 该函数有时被称作频率为
    $$ n $$
    的特征.
- 定义 (__三角多项式__) 设
  $$ f $$
  是
  $$ C(R / Z; C) $$
  中的函数. 如果存在一个整数
  $$ N ≥ 0 $$
  和一个复数序列
  $$ (c_n)_{n = -N}^{N} $$
  使得
  $$ f = \sum_{n = -N}^{N} c_n e_n $$,
  那么我们称函数
  $$ f $$
  是一个`三角多项式`.

```
根据傅里叶定理, 我们可以把 C(R/Z; C) 中的任意一个函数写成傅里叶级数的形式.
傅里叶级数与三角多项式的关系, 就像幂级数与多项式的关系那样.
为了把函数写成傅里叶级数的形式, 我们将使用内积结构.
```

- 引理 (__全体特征构成一个标准正交系__) 对于任意的整数
  $$ n $$
  和
  $$ m $$,
  当
  $$ n = m $$
  时,
  $$ \langle e_n, e_m \rangle = 1 $$;
  当
  $$ n ≠ m $$
  时,
  $$ \langle e_n, e_m \rangle = 0 $$.
  同时还有
  $$ \| e_n \| = 1 $$.

- 推论 设
  $$ f = \sum_{n = -N}^{N} c_n e_n $$
  是一个三角多项式, 那么对于所有的整数
  $$ -N ≤ n ≤ N $$,
  有如下公式:
  - $$ c_n = \langle f, e_n \rangle $$
  - 另外, 只要
    $$ n > N $$
    或者
    $$ n < -N $$,
    我们就有
    $$ 0 = \langle f, e_n \rangle $$.
  - 最后, 我们还有恒等式
    $$ \| f \|_{2}^{2} = \sum_{n = -N}^{N} | c_n |^2 $$

- 定义 (__傅里叶变换__) 对于任意的函数
  $$ f \in C(R / Z; C) $$
  和任意的整数
  $$ n \in Z $$,
  我们把
  $$ f $$
  的第
  $$ n $$
  个傅里叶系数, 记作
  $$ \hat{f}(n) $$,
  定义为
  - $$
      \hat{f}(n) := \langle f, e_n \rangle =
      \int_{[0, 1]} f(x) e^{-2 \pi inx} dx
    $$
  - 函数
    $$ \hat{f} : Z \to C $$
    被称为
    $$ f $$
    的`傅里叶变换`.
- 于是, 只要
  $$ f = \sum_{n = -N}^{N} c_n e_n $$
  是一个三角多项式, 那么就有
  - $$
      f = \sum_{n = -N}^{N} \langle f, e_n \rangle e_n
        = \sum_{n = -\infty}^{\infty} \langle f, e_n \rangle e_n
    $$
- 于是我们得到了`傅里叶反演公式`:
  - $$ f = \sum_{n = -\infty}^{\infty} \hat{f}(n) e_n $$
  - 也就是说,
  - $$
      f(x) = \sum_{n = - \infty}^{\infty} \hat{f}(n)
      e^{2 \pi inx}
    $$
  - 上式右端称为
    $$ f $$
    的`傅里叶级数`.
- 另外, 根据推论的第二个恒等式, 我们有 Plancherel 公式
  - $$
      \| f \|_{2}^{2} = \sum_{n = - \infty}^{\infty}
      | \hat{f}(n) |^2
    $$
- 注 需要强调的是, 我们目前只证明了当
  $$ f $$
  是三角多项式时的傅里叶反演公式和 Plancherel 公式.
  注意, 在这种情形下, 绝大多数傅里叶系数
  $$ \hat{f} (n) $$
  都是零 (事实上, 仅当
  $$ -N ≤ n ≤ N $$
  时, 傅里叶系数才不为零), 因此这里的无限和实际上就是有限和.
  - 这样也就不存在关于上述级数在什么意义下收敛的讨论.
    因为级数是有限和, 所以它既是逐点收敛和一致收敛的, 也是依
    $$ L^2 $$
    度量收敛的.

> 此处和科恩的量子力学遥相呼应, 而且更加言简意赅.
  这就是阅读的乐趣, 在不同的著作之间看见关联.
  话说回来, 因为有量子力学的背景在前, 此处才会十分的具象化.

```
接下来, 我们将把傅里叶反演公式和 Plancherel 公式推广到
C(R/Z; C) 中的一般函数上, 而不仅仅是三角多项式上.
(上述公式也可以推广到像方波这样的间断函数上, 但我们不讨论这部分内容.)
为此, 我们将会用到魏尔斯特拉斯逼近定理,
但这一次我们要用三角多项式来一致逼近连续的周期函数.
正如在多项式的魏尔斯特拉斯逼近定理的证明中用到了卷积一样,
我们也要为周期函数定义一个卷积的概念.
```

> 在数学内容的讲解布局上, 陶哲轩堪称我所见者第一人.

- 定理 设
  $$ f \in C(R / Z; C) $$,
  并设
  $$ ε > 0 $$.
  那么存在一个三角多项式
  $$ P $$
  使得
  $$ \| f - P \|_{\infty} ≤ ε $$.
  - 该定理断定了任意一个连续的周期函数都可以用三角多项式来一致逼近.
  - 也就是说, 如果设
    $$ P(R / Z; C) $$
    表示全体三角多项式的空间, 那么
    $$ P(R / Z; C) $$
    在
    $$ L^{\infty} $$
    度量下的闭包就是
    $$ C(R / Z; C) $$.

```
这个定理可以直接用多项式的魏尔斯特拉斯逼近定理来证明,
而这两个定理都是更一般的斯通-魏尔斯特拉斯定理的特殊情形,
在这里我们不讨论斯通-魏尔斯特拉斯定理.
```

- 定义 (__周期卷积__) 设
  $$ f, g \in C(R / Z; C) $$,
  那么
  $$ f $$
  和
  $$ g $$
  的`周期卷积`
  $$ f * g: R \to C $$
  被定义为
  - $$ f * g(x) := \int_{[0, 1]} f(y) g(x - y) dy $$

```
注意, 上面这个式子与紧支撑函数的卷积概念稍有不同,
因为我们只在 [0, 1] 上求积分, 而不是在整个 R 上求积分.
因此从原则上来说, 我们为符号 f * g 赋予了两个不同的含义.
但在实践中, 这并不会造成混淆,
因为一个非零的函数不可能同时既是周期函数又是紧支撑函数.
```

- 引理 (__周期卷积的基本性质__) 设
  $$ f, g, h \in C(R / Z; C) $$.
  - (a) (__封闭性__) 卷积
    $$ f * g $$
    是连续的, 并且是
    $$ Z $$
    周期的. 换言之,
    $$ f * g \in C(R / Z; C) $$.
  - (b) (__交换性__)
    $$ f * g = g * f $$.
  - (c) (__双线性性质__)
    $$ f * (g + h) = f * g + f * h $$
    且
    $$ (f + g) * h = f * h + g * h $$.
    对于任意的复数
    $$ c $$,
    有
    $$ c(f * g) = (cf) * g = f * (cg) $$.

- 对于任意的
  $$ f \in C(R / Z; C) $$
  和任意的整数
  $$ n $$,
  有
  - $$ f * e_n = \hat{f}(n) e_n $$
  - 因此,
    $$ C(R / Z; C) $$
    中任意一个函数与三角多项式的周期卷积都仍是一个三角多项式.

- 定义 (__周期恒等逼近__) 设
  $$ ε > 0 $$
  且
  $$ 0 < δ < 1/2 $$,
  如果函数
  $$ f \in C(R / Z; C) $$
  满足下列性质, 那么
  $$ f $$
  就被称为周期
  $$ (ε, δ) $$
  恒等逼近.
  - (a) 对于所有的
    $$ x \in R $$,
    都有
    $$ f(x) ≥ 0 $$;
    并且
    $$ \int_{[0, 1]} f = 1 $$.
  - (b) 对于所有的
    $$ δ ≤ |x| ≤ 1 - δ $$,
    都有
    $$ f(x) < ε $$.

- 引理 对于每一个
  $$ ε > 0 $$
  和
  $$ 0 < δ < 1/2 $$,
  都存在一个三角多项式
  $$ P $$,
  它是一个
  $$ (ε, δ) $$
  恒等逼近.

- 注意, 我们只得到了傅里叶级数
  $$ \sum_{n = -∞}^{∞} \hat{f}(n) e_n $$
  依
  $$ L^2 $$
  度量收敛于
  $$ f $$
  的结论. 有人或许会提出这样的疑问:
  这个结论是否也对一致收敛和逐点收敛成立?
  然而 (或许会让人感到有些意外), 对这两种收敛方式的回答都是否定的.
  - 但如果假定函数
    $$ f $$
    不仅是连续的, 而且还是连续可微的,
    那么上述结论对于逐点收敛成立. 如果假定
    $$ f $$
    是二次连续可微的, 那么这个结论也对一致收敛成立.

- 定理 (__Plancherel 定理__) 对于任意的
  $$ f \in C(R / Z; C) $$,
  级数
  $$ \sum_{n = - \infty}^{\infty} |\hat{f}(n)|^2 $$
  是绝对收敛的, 并且
  - $$ \| f \|_2^2 = \sum_{n = - \infty}^{\infty} |\hat{f}(n)|^2 $$
  - 这个定理也被称作帕塞瓦尔定理.

### 多元微分学

```
我们把行向量和列向量看作是不同空间中的元素.
```

- 定义 (__线性变换__) 线性变换
  $$ T: R^n \to R^m $$
  就是一个从欧几里得空间
  $$ R^n $$
  到另一个欧几里得空间
  $$ R^m $$
  的函数, 并且该函数还要满足下面这两个公理.
  - (a) (可加性) 对于任意的
    $$ x, x' \in R^n $$,
    都有
    $$ T(x + x') = Tx + Tx' $$.
  - (b) (齐次性) 对于任意的
    $$ x \in R^n $$
    和任意的
    $$ c \in R $$,
    都有
    $$ T(cx) = cTx $$.

> 我想说, 这是我见过的最简洁的版本

- 定义 (__可微性__) 设
  $$ E $$
  是
  $$ R^n $$
  的子集,
  $$ f: E \to R^m $$
  是一个函数,
  $$ x_0 \in E $$
  是一个点, 并设
  $$ L: R^n \to R^m $$
  是一个线性变换. 如果有
  - $$
      \lim_{x \to x_0; x \in E - \{ x_0 \}}
      \frac{\| f(x) - (f(x_0) + L(x - x_0)) \|}{\| x - x_0 \|}
      = 0
    $$
  - 其中
    $$ \| x \| $$
    是
    $$ x $$
    的长度 (在
    $$ l^2 $$
    度量下):
  - $$
      \| (x_1, x_2, ..., x_n) \| =
      (x_1^2 + x_2^2 + ... + x_n^2)^{1/2}
    $$
  - 那么我们称
    $$ f $$
    在
    $$ x_0 $$
    处是可微的, 并且导数为
    $$ L $$.

- 引理 (__导数的唯一性__) 设
  $$ E $$
  是
  $$ R^n $$
  的子集,
  $$ f: E \to R^m $$
  是一个函数,
  $$ x_0 \in E $$
  是
  $$ E $$
  的内点, 并设
  $$ L_1: R^n \to R^m $$
  和
  $$ L_2: R^n \to R^m $$
  都是线性变换. 如果
  $$ f $$
  在
  $$ x_0 $$
  处可微, 并且导数为
  $$ L_1 $$,
  同时
  $$ f $$
  在
  $$ x_0 $$
  处还有导数
  $$ L_2 $$,
  那么
  $$ L_1 = L_2 $$.

- 有时, 我们把
  $$ f' $$
  称为
  $$ f $$
  的`全导数`, 以区别于`偏导数`和`方向导数`的概念. 此外, 全导数
  $$ f' $$
  还与`导数矩阵`
  $$ Df $$
  有着密切的关联.

- 定义 (__方向导数__) 设
  $$ E $$
  是
  $$ R^n $$
  的子集,
  $$ f: E \to R^m $$
  是一个函数,
  $$ x_0 $$
  是
  $$ E $$
  的内点, 并设
  $$ v $$
  是
  $$ R^n $$
  中的向量. 如果极限
  - $$
      \lim_{t \to 0; t > 0, x_0 + tv \in E}
      \frac{f(x_0 + tv) - f(x_0)}{t}
    $$
  - 存在, 那么我们称
    $$ f $$
    在
    $$ x_0 $$
    处沿方向
    $$ v $$
    可微, 并把上述极限记作
    $$ D_v f(x_0) $$:
  - $$
      D_v f(x_0) := \lim_{t \to 0; t > 0}
      \frac{f(x_0 + tv) - f(x_0)}{t}
    $$
- 注意, 这里的除数是标量
  $$ t $$,
  而不是向量. 因此该定义是有意义的, 并且
  $$ D_v f(x_0) $$
  是
  $$ R^m $$
  中的向量. 如果向量
  $$ v $$
  是指`朝内`的方向 (这推广了单变量微积分中左导数和右导数的概念), 那么在
  $$ E $$
  的边界上定义方向导数也是有可能的.
  - 但此处我们不讨论这一点.

- 引理 设
  $$ E $$
  是
  $$ R^n $$
  的子集,
  $$ f: E \to R^m $$
  是一个函数,
  $$ x_0 $$
  是
  $$ E $$
  的内点, 并设
  $$ v $$
  是
  $$ R^n $$
  中的向量. 如果
  $$ f $$
  在
  $$ x_0 $$
  处是可微的, 那么
  $$ f $$
  在
  $$ x_0 $$
  处沿方向
  $$ v $$
  也可微, 并且
  - $$ D_v f(x_0) = f'(x_0) v $$

```
注 从这个引理可以看出, 全可微性蕴涵着方向可微性.
但是, 反之不成立, 与方向导数密切相关的一个概念是偏导数的概念.
```

- 定义 (__偏导数__) 设
  $$ E $$
  是
  $$ R^n $$
  的子集,
  $$ f: E \to R^m $$
  是一个函数,
  $$ x_0 $$
  是
  $$ E $$
  的内点, 并设
  $$ 1 ≤ j ≤ n $$.
  那么
  $$ f $$
  在
  $$ x_0 $$
  处关于变量
  $$ x_j $$
  的偏导数, 记作
  $$ \frac{\partial f}{\partial x_j} (x_0) $$,
  被定义为
  - $$
      \frac{\partial f}{\partial x_j} (x_0) :=
      \lim_{t \to 0; t \neq 0, x_0 + t e_j \in E}
      \frac{f(x_0 + t e_j) - f(x_0)}{t} =
      \frac{d}{dt} f(x_0 + t e_j) |_{t = 0}
    $$
  - 当然前提是上述极限存在. 如果极限不存在, 那么
    $$ \frac{\partial f}{\partial x_j} (x_0) $$
    就是无定义的.
- 通俗地说, 偏导数可以通过这样的方式来得到: 固定除了
  $$ x_j $$
  以外的所有变量, 然后把函数看作关于
  $$ x_j $$
  的单变量函数, 进而求其导数.
  - 注意, 如果
    $$ f $$
    在
    $$ R^m $$
    中取值, 那么
    $$ \frac{\partial f}{\partial x_j} $$
    也在
    $$ R^m $$
    中取值.
  - 实际上, 如果我们把
    $$ f $$
    写成
    $$ f = (f_1, ..., f_m) $$,
    那么容易得出
  - $$
      \frac{\partial f}{\partial x_j} (x_0) =
      (\frac{\partial f_1}{\partial x_j} (x_0),
      ...,
      \frac{\partial f_m}{\partial x_j} (x_0))
    $$
  - 也就是说, 要想对一个向量值函数求微分,
    我们只需分别对其中的每个分量求微分就可以了.

- 如果一个函数在
  $$ x_0 $$
  处是可微的, 那么该函数在
  $$ x_0 $$
  处的所有偏导数
  $$ \frac{\partial f}{\partial x_j} $$
  都存在, 并且
  - $$ \frac{\partial f}{\partial x_j} (x_0) = f'(x_0) e_j $$
  - 另外, 如果
    $$ v = (v_1, ..., v_n) = \sum_j v_j e_j $$,
    那么
  - $$
      D_v f(x_0) = f'(x_0) \sum_j v_j e_j =
      \sum_j v_j f'(x_0) e_j
    $$
  - 这是因为
    $$ f'(x_0) $$
    是线性的, 于是
  - $$ D_v f(x_0) = \sum_j v_j \frac{\partial f}{\partial x_j} (x_0) $$
  - 因此, 如果函数在
    $$ x_0 $$
    处是可微的, 那么我们就可以用偏导数来表示方向导数.

> 线性! 此处值得回味~

- 我们不能只因为函数在
  $$ x_0 $$
  处的偏导数存在, 就说该函数在
  $$ x_0 $$
  处是可微的.
  - 但是, 由下面这个定理可知, 如果函数在
    $$ x_0 $$
    处的偏导数不仅存在而且还是连续的, 那么该函数在
    $$ x_0 $$
    处就是可微的.
- 定理 设
  $$ E $$
  是
  $$ R^n $$
  的子集,
  $$ f: E \to R^m $$
  是一个函数,
  $$ F $$
  是
  $$ E $$
  的子集, 并设
  $$ x_0 $$
  是
  $$ F $$
  的内点. 如果
  $$ f $$
  在
  $$ F $$
  上的全体偏导数
  $$ \frac{\partial f}{\partial x_j} $$
  都存在, 并且它们在
  $$ x_0 $$
  处也都是连续的, 那么
  $$ f $$
  在
  $$ x_0 $$
  处是可微的, 而且线性变换
  $$ f'(x_0): R^n \to R^m $$
  被定义为
  - $$
      f'(x_0)(v_j)_{1 ≤ j ≤ n} =
      \sum_{j = 1}^{n} v_j \frac{\partial f}{\partial x_j} (x_0)
    $$
  - 特别地, 如果
    $$ f: E \to R $$
    是一个实值函数, 并且
    $$ f $$
    在
    $$ x_0 $$
    处的`梯度`
    $$ \nabla f(x_0) $$
    被定义为
    $$ n $$
    维行向量
    $$
      \nabla f(x_0) := (
        \frac{\partial f}{\partial x_1}(x_0),
        ...,
        \frac{\partial f}{\partial x_n}(x_0)
      )
    $$,
    那么只要
    $$ x_0 $$
    是某个梯度存在且连续的区域的内点, 我们就有熟知的公式
  - $$ D_v f(x_0) = v \cdot \nabla f(x_0) $$

> 梯度, 偏导数, 方向导数; 又是个值得回味的地方~ 线性!

- [微分矩阵](https://en.wikipedia.org/wiki/Matrix_calculus)

- 定理 (__多元微积分链式法则__) 设
  $$ E $$
  是
  $$ R^n $$
  的子集,
  $$ F $$
  是
  $$ R^m $$
  的子集. 设
  $$ f: E \to F $$
  是一个函数,
  $$ g: F \to R^p $$
  是另一个函数, 并设
  $$ x_0 $$
  是
  $$ E $$
  的内点. 如果
  $$ f $$
  在
  $$ x_0 $$
  处是可微的, 并且
  $$ f(x_0) $$
  是
  $$ F $$
  的内点, 同时
  $$ g $$
  在
  $$ f(x_0) $$
  处也是可微的, 那么
  $$ g \circ f: E \to R^p $$
  在
  $$ x_0 $$
  处可微, 而且还有公式
  - $$ (g \circ f)'(x_0) = g'(f(x_0)) f'(x_0) $$
  - 作为一个推论, 我们得到
  - $$ D(g \circ f) (x_0) = Dg(f(x_0)) Df(x_0) $$

```
也就是说, 我们可以用矩阵和矩阵乘法来描述链式法则,
以此来代替用线性变换和复合运算描述的链式法则.
```

> 线性! 链式法则~

- 设
  $$ T: R^n \to R^m $$
  是一个线性变换. 我们观察到
  $$ T $$
  在每一点处都是连续可微的. 实际上, 对于每一个
  $$ x $$
  都有
  $$ T'(x) = T $$
  (这个等式看起来好像有点奇怪. 但如果把它看成
  $$ \frac{d}{dx} (Tx) = T $$
  的形式, 那么理解起来可能就更加容易了). 因此, 对于任意的可微函数
  $$ f: E \to R^n $$,
  $$ Tf: E \to R^m $$
  也是可微的. 那么由链式法则可得,
  - $$ (Tf)'(x_0) = T(f'(x_0)) $$
  - 这个结论推广了一元微积分法则
    $$ (cf)' = c(f') $$,
    其中
    $$ c $$
    是一个常数.

> 妙啊~

- 下面是链式法则的另一种非常有用的特殊情形: 设
  $$ f: R^n \to R^m $$
  是一个可微函数, 并且对于每一个
  $$ j = 1, ..., n $$,
  $$ x_j: R \to R $$
  都是可微函数. 那么
  - $$
      \frac{d}{dt} f(x_1(t), x_2(t), ..., x_n(t)) =
      \sum_{j = 1}^{n} x'_j (t) \frac{\partial f}{\partial x_j}
      (x_1(t), x_2(t), ..., x_n(t))
    $$

- 定理 (__克莱罗定理__) 设
  $$ E $$
  是
  $$ R^n $$
  的一个开子集, 并设
  $$ f: E \to R^m $$
  是
  $$ E $$
  上的二次连续可微函数. 那么对于所有的
  $$ 1 ≤ i $$,
  $$ j ≤ n $$
  和所有的
  $$ x_0 \in E $$,
  都有
  - $$
      \frac{\partial}{\partial x_j}
      \frac{\partial f}{\partial x_i} (x_0) =
      \frac{\partial}{\partial x_i}
      \frac{\partial f}{\partial x_j} (x_0)
    $$.

```
注意, 如果没有"二阶导数是连续的"这个假设前提, 那么克莱罗定理就不成立了.
```

- 定义 (__压缩__) 设
  $$ (X, d) $$
  是一个度量空间, 并设
  $$ f: X \to X $$
  是一个映射. 如果对于所有的
  $$ x, y \in X $$
  都有
  $$ d(f(x), f(y)) ≤ d(x, y) $$,
  那么我们称
  $$ f $$
  是一个`压缩映射`. 如果存在一个常数
  $$ 0 < c < 1 $$,
  使得对于所有的
  $$ x, y \in X $$
  都有
  $$ d(f(x), f(y)) ≤ cd(x, y) $$,
  那么我们称
  $$ f $$
  是一个`严格压缩映射`,
  $$ c $$
  被称为
  $$ f $$
  的`压缩常数`.

- 定义 (__不动点__) 设
  $$ f: X \to X $$
  是一个映射, 并设
  $$ x \in X $$.
  如果
  $$ f(x) = x $$,
  那么我们称
  $$ x $$
  是
  $$ f $$
  的`不动点`.

- 压缩映射不一定有不动点. 例如, 被定义为
  $$ f(x) = x + 1 $$
  的映射
  $$ f: R \to R $$
  就没有不动点. 但是, 严格压缩映射一定有不动点, 至少当
  $$ X $$
  是完备空间时如此.

- 定理 (__压缩映射定理__) 设
  $$ (X, d) $$
  是一个度量空间, 并设
  $$ f: X \to X $$
  是一个严格压缩映射, 那么
  $$ f $$
  最多有一个不动点. 另外, 如果假设
  $$ X $$
  是一个非空的完备空间, 那么
  $$ f $$
  恰好有一个不动点.

- 注 压缩映射定理是`不动点定理`的一个例子. 不动点定理就是在某些特定条件下,
  能够保证映射有不动点的定理. 还存在一些其他有用的不动点定理,
  其中一个有趣的定理就是所谓的`毛球定理`.
  - 该定理指出, 任意一个从球面
    $$ S^2 := \{(x, y, z) \in R^3 : x^2 + y^2 + z^2 = 1 \} $$
    到其自身的连续映射
    $$ f: S^2 \to S^2 $$
    都必有一个不动点或者一个反不动点 (即满足
    $$ f(x) = -x $$
    的点
    $$ x \in S^2 $$).
  - 对这个定理的证明可以参阅任何一本拓扑学教材, 而且它超出了本书的范围.

```
我们将给出压缩映射定理的一个推论, 它对于反函数定理有着重要的作用.
这个推论主要是指对于任意一个定义在球上的映射 f 而言,
如果 f 只是对恒等映射的"小小的"变动,
那么 f 仍是一对一的, 而且它不会在球的内部造成任何洞.
```

- 引理 设
  $$ B(0, r) $$
  是
  $$ R^n $$
  中以原点为中心的球, 并设
  $$ g: B(0, r) \to R^n $$
  是一个映射, 它使得
  $$ g(0) = 0 $$,
  并且对于所有的
  $$ x, y \in B(0, r) $$
  都有
  - $$ \| g(x) - g(y) \| ≤ \frac{1}{2} \| x - y \| $$
  - 这里的
    $$ \| x \| $$
    表示
    $$ x $$
    在
    $$ R^n $$
    中的长度.
  - 那么定义为
    $$ f(x) := x + g(x) $$
    的函数
    $$ f: B(0, r) \to R^n $$
    是一对一的, 并且
    $$ f $$
    的象
    $$ f(B(0, r)) $$
    包含球
    $$ B(0, r/2) $$.

- 定理 (__反函数定理__) 设
  $$ E $$
  是
  $$ R^n $$
  的一个开子集, 并设
  $$ f: E \to R^n $$
  是
  $$ E $$
  上的一个连续可微函数. 如果
  $$ x_0 \in E $$
  使得线性变换
  $$ f'(x_0): R^n \to R^n $$
  可逆, 那么在
  $$ E $$
  中存在一个包含点
  $$ x_0 $$
  的开集
  $$ U $$,
  并且在
  $$ R^n $$
  中存在一个包含
  $$ f(x_0) $$
  的开集
  $$ V $$,
  使得
  $$ f $$
  是从
  $$ U $$
  到
  $$ V $$
  的双射. 特别地, 存在逆映射
  $$ f^{-1}: V \to U $$.
  另外, 这个逆映射在
  $$ f(x_0) $$
  处可微, 并且
  - $$ (f^{-1})'(f(x_0)) = (f'(x_0))^{-1} $$

- 关于一个函数什么时候在
  $$ x_0 $$
  处是 (局部) 可逆的,
  反函数定理给出了一个有用的判别准则. 我们只需要它的导数
  $$ f'(x_0) $$
  是可逆的 (此时我们甚至可以得到更多的信息, 比如我们可以计算
  $$ f^{-1} $$
  在
  $$ f(x_0) $$
  处的导数).
  - 当然, 这就要问, 我们应该如何判断线性变换
    $$ f'(x_0) $$
    是不是可逆的. 回顾已知的
    $$ f'(x_0) = L_{D f(x_0)} $$,
    可知, 线性变换
    $$ f'(x_0) $$
    可逆当且仅当矩阵
    $$ D f(x_0) $$
    是可逆矩阵.
  - 有很多方法可以验证像
    $$ D f(x_0) $$
    这样的矩阵是不是可逆的. 例如, 我们可以利用行列式, 或者高斯消元法.
    对此我们不展开讨论.
- 如果
  $$ f'(x_0) $$
  存在但不可逆, 那么反函数定理就不适用. 在这种情形下,
  $$ f^{-1} $$
  在
  $$ x_0 $$
  处不可能存在, 更不会在
  $$ x_0 $$
  处可微. 但是,
  $$ f $$
  仍然可以是可逆的.
  - 例如, 定义为
    $$ f(x) = x^3 $$
    的一元函数
    $$ f: R \to R $$
    是可逆的, 虽然
    $$ f'(0) $$
    是不可逆的.

- 在隐函数定理中, 如果导数
  $$ \frac{\partial f}{\partial x_n} $$
  在某一点处的值等于
  $$ 0 $$,
  那么在该点附近集合
  $$ \{ x \in R^n: f(x) = 0 \} $$
  好像就不能写成变量
  $$ x_n $$
  关于另外
  $$ n - 1 $$
  个变量的函数图. 但是, 如果其他某个导数
  $$ \frac{\partial f}{\partial x_j} $$
  不等于
  $$ 0 $$,
  那么由隐函数定理可知, 变量
  $$ x_j $$
  可以由另外
  $$ n - 1 $$
  个变量来确定.
  - 于是, 只要梯度
    $$ \nabla f $$
    不全为零, 集合
    $$ \{ x \in R^n: f(x) = 0 \} $$
    就可以写成某个变量
    $$ x_j $$
    关于另外
    $$ n - 1 $$
    个变量的函数图.
  - (圆周
    $$ \{ (x, y) \in R^2: x^2 + y^2 - 1 = 0 \} $$
    就是一个很好的例子. 它既不是
    $$ y $$
    关于
    $$ x $$
    的图, 也不是
    $$ x $$
    关于
    $$ y $$
    的图, 但在每一点附近它必定是两者之一. 这是因为
    $$ x^2 + y^2 - 1 $$
    的梯度在圆周上不可能等于
    $$ 0 $$.)
  - 不过, 如果梯度
    $$ \nabla f $$
    在某个点
    $$ x_0 $$
    处的确不存在, 那么我们称
    $$ f $$
    在
    $$ x_0 $$
    处有`临界点`, 而且函数在该点处的性状将会更加复杂.
  - 例如, 集合
    $$ \{ (x, y) \in R^2: x^2 - y^2 = 0 \} $$
    在
    $$ (0, 0) $$
    处有临界点, 它在
    $$ (0, 0) $$
    附近不能被看作任何函数的图 (它是两条直线的并集).

- 注 如果一个集合在每一点处都能看成连续函数的图,
  那么这个集合就叫作`流形`. 因此, 如果集合
  $$ \{ x \in R^n: f(x) = 0 \} $$
  中不包含
  $$ f $$
  的临界点, 那么它就是一个流形.
  - 在现代几何学中 (尤其是微分几何学和代数几何学), 流形理论非常重要.

### 勒贝格测度

- 为了知道如何计算积分
  $$ \int_Ω f $$,
  我们必须先弄清楚一个更基础, 更根本的问题: 应该如何计算
  $$ Ω $$
  的长度, 面积或者体积?
  - 要想知道这个问题为什么与积分有关, 我们必须注意, 如果能够求出函数
    $$ 1 $$
    在
    $$ Ω $$
    上的积分, 那么我们就得到了
    $$ Ω $$
    的长度 (如果
    $$ Ω $$
    是一维的),
    $$ Ω $$
    的面积 (如果
    $$ Ω $$
    是二维的), 或者
    $$ Ω $$
    的体积 (如果
    $$ Ω $$
    是三维的).
  - 为了避免划分成若干种不同维度的情形, 我们把
    $$ Ω $$
    的长度, 面积和体积 (或者超体积等) 这些与欧几里得空间
    $$ R^n $$
    有关的概念统称为
    $$ Ω $$
    的`测度`.

- 我们不可能找到一个合理的方法使得
  $$ R^n $$
  中的每一个子集都能被指派一个测度. 但我们可以采取一些补救措施, 那就是只测量
  $$ R^n $$
  中一个特定类型的集合, 即`可测集`. 我们只在这些可测集
  $$ Ω $$
  上定义测度
  $$ m(Ω) $$.

- 设
  $$ R^n $$
  是一个欧几里得空间, 本章的目标是定义`可测集`的概念, 它是
  $$ R^n $$
  的一类特殊子集. 对于每一个可测集
  $$ Ω \subset R^n $$,
  我们把`勒贝格测度`
  $$ m(Ω) $$
  定义为
  $$ [0, ∞] $$
  中的一个特定数字. 可测集满足下列性质.
  - (i) (__博雷尔性质__)
    $$ R^n $$
    中的每一个开集都是可测集, 每一个闭集也都是可测集.
  - (ii) (__互补性__) 如果
    $$ Ω $$
    是可测集, 那么
    $$ R^n \backslash Ω $$
    也是可测集.
  - (iii) (__布尔代数性质__) 如果
    $$ (Ω_j)_{j \in J} $$
    是任意的有限多个可测集 (那么
    $$ J $$
    是有限的), 那么它们的并集
    $$ \cup_{j \in J} Ω_j $$
    和交集
    $$ \cap_{j \in J} Ω_j $$
    也都是可测集.
  - (iv) (__σ 代数性质__) 如果
    $$ (Ω_j)_{j \in J} $$
    是任意可数个可测集 (那么
    $$ J $$
    是可数的), 那么它们的并集
    $$ \cup_{j \in J} Ω_j $$
    和交集
    $$ \cap_{j \in J} Ω_j $$
    也都是可测集.

> 重复一个例子: 如果
  $$ E $$
  只包含了一部分边界点, 而不包含其他边界点, 那么
  $$ E $$
  既不是开的也不是闭的.

- 对于每一个可测集
  $$ Ω $$,
  我们都指派了一个满足如下性质的`勒贝格测度`
  $$ m(Ω) $$.
  - (v) (__空集__) 空集
    $$ \varnothing $$
    的测度是
    $$ m(\varnothing) = 0 $$.
  - (vi) (__正性__) 对于每一个可测集
    $$ Ω $$,
    都有
    $$ 0 ≤ m(Ω) ≤ +∞ $$.
  - (vii) (__单调性__) 如果
    $$ A \subseteq B $$,
    并且
    $$ A $$
    和
    $$ B $$
    都是可测集, 那么
    $$ m(A) ≤ m(B) $$.
  - (viii) (__有限次可加性__) 如果
    $$ (A_j)_{j \in J} $$
    是有限多个可测集, 那么
    $$ m(\cup_{j \in J} A_j) ≤ \sum_{j \in J} m(A_j) $$.
  - (ix) (__有限可加性__) 如果
    $$ (A_j)_{j \in J} $$
    是有限多个彼此不相交的可测集, 那么
    $$ m(\cup_{j \in J} A_j) = \sum_{j \in J} m(A_j) $$.
  - (x) (__可数次可加性__) 如果
    $$ (A_j)_{j \in J} $$
    是可数个可测集, 那么
    $$ m(\cup_{j \in J} A_j) ≤ \sum_{j \in J} m(A_j) $$.
  - (xi) (__可数可加性__) 如果
    $$ (A_j)_{j \in J} $$
    是可数个彼此不相交的可测集, 那么
    $$ m(\cup_{j \in J} A_j) = \sum_{j \in J} m(A_j) $$.
  - (xii) (__正规化__) 单位立方体
    $$ [0, 1]^n = \{( x_1, ..., x_n) \in R^n: $$
    对于所有的
    $$ 1 ≤ j ≤ n $$
    都有
    $$ 0 ≤ x_j ≤ 1 \} $$
    的测度是
    $$ m([0, 1]^n) = 1 $$.
  - (xiii) (__平移不变性__) 如果
    $$ Ω $$
    是一个可测集, 并且
    $$ x \in R^n $$,
    那么
    $$ x + Ω := \{ x + y: y \in Ω \} $$
    也是一个可测集, 并且
    $$ m(x + Ω) = m(Ω) $$.

```
在构造勒贝格测度之前, 我们先来讨论寻找集合测度的朴素方法,
即我们尝试用一些盒子来覆盖集合, 然后再把这些盒子的体积累加在一起.
这种方法应该是有效的, 它提出了外测度这一概念. 外测度适用于每一个集合,
并且满足除了可加性 (ix) 和 (xi) 之外的所有性质 (v) ~ (xiii).
```

- 单位立方体
  $$ (0, 1)^n $$
  就是一个盒子, 它的体积是
  $$ 1 $$.
  在一维
  $$ n = 1 $$
  的情形下, 盒子与开区间是一样的.
  容易验证, 在一般维度下开盒子其实就是开集.
  - 注意, 如果存在一个
    $$ i $$
    使得
    $$ b_i = a_i $$,
    那么盒子就是体积为零的空集,
    但我们仍把它看作一个盒子 (尽管这相当不合常理).

- 定义 (__勒贝格可测性__) 设
  $$ E $$
  是
  $$ R^n $$
  的子集. 我们称
  $$ E $$
  是勒贝格可测的, 或简称为可测的, 当且仅当对于
  $$ R^n $$
  的每一个子集
  $$ A $$
  都有恒等式
  - $$ m^{*} (A) = m^{*} (A \cap E) + m^{*} (A \backslash E) $$
  - 如果
    $$ E $$
    是可测的, 那么我们把
    $$ E $$
    的`勒贝格测度`定义为
    $$ m(E) = m^{*} (E) $$;
    如果
    $$ E $$
    不可测, 那么
    $$ m(E) $$
    无定义.
- 也就是说,
  $$ E $$
  是可测的意味着, 当我们用
  $$ E $$
  把任意的集合
  $$ A $$
  划分成两部分时, 可加性保持不变. 当然, 如果
  $$ m^{*} $$
  是有限可加的, 那么每一个集合
  $$ E $$
  都是可测的.
  - 但是, 并非所有的集合都是有限可加的.
    我们可以把可测集看作能使有限可加性成立的集合. 我们有时把
    $$ m(E) $$
    写成带有下标的
    $$ m_n (E) $$,
    以此来强调我们使用的是
    $$ n $$
    维勒贝格测度.

- 引理 (__可测集的性质__)
  - (a) 如果
    $$ E $$
    是可测的, 那么
    $$ R^n \backslash E $$
    也是可测的.
  - (b) (__平移不变性__) 如果
    $$ E $$
    是可测的, 并且
    $$ x \in R^n $$,
    那么
    $$ x + E $$
    也是可测的, 并且有
    $$ m(x + E) = m(E) $$.
  - (c) 如果
    $$ E_1 $$
    和
    $$ E_2 $$
    都是可测的, 那么
    $$ E_1 \cap E_2 $$
    和
    $$ E_1 \cup E_2 $$
    也都可测.
  - (d) (__布尔代数性质__) 如果
    $$ E_1 $$,
    $$ E_2 $$,
    ...,
    $$ E_N $$
    都是可测的, 那么
    $$ \cup_{j = 1}^N E_j $$
    和
    $$ \cap_{j = 1}^N E_j $$
    也都是可测的.
  - (e) 每一个开盒子都是可测的, 每一个闭盒子也都是可测的.
  - (f) 任意一个外测度为零的集合
    $$ E $$
    (即
    $$ m^{*} (E) = 0 $$)
    都是可测的.

- 引理 (__有限可加性__) 如果
  $$ (E_j)_{j \in J} $$
  是有限个不相交的可测集, 而
  $$ A $$
  是任意一个集合 (不一定是可测的), 那么有
  - $$
      m^{*} (A \cap \bigcup_{j \in J} E_j) =
      \sum_{j \in J} m^{*} (A \cap E_j)
    $$
  - 另外, 还有
    $$ m(\cup_{j \in J} E_j) = \sum_{j \in J} m (E_j) $$.

- 推论 如果
  $$ A \subseteq B $$
  是两个可测集, 那么
  $$ B \backslash A $$
  也是可测的, 并且
  - $$ m(B \backslash A) = m(B) - m(A) $$

- 引理 (__可数可加性__) 如果
  $$ (E_j)_{j \in J} $$
  是可数个不相交的可测集, 那么
  $$ \cup_{j \in J} E_j $$
  是可测的, 并且
  $$ m(\cup_{j \in J} E_j) = \sum_{j \in J} m(E_j) $$.

- 引理 (__σ 代数性质__) 如果
  $$ (Ω_j)_{j \in J} $$
  是任意可数个可测集 (从而
  $$ J $$
  是可数的), 那么并集
  $$ \cup_{j \in J} Ω_j $$
  和交集
  $$ \cap_{j \in J} Ω_j $$
  也都是可测的.

```
引理 每一个开集都能写成可数个或者有限个开盒子的并集.
```

- 定义 (__可测函数__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to R^m $$
  是一个函数. 函数
  $$ f $$
  是`可测的`, 当且仅当对于每一个开集
  $$ V \subseteq R^m $$,
  $$ f^{-1} (V) $$
  都是可测的.

```
就像之前讨论的那样, 我们在现实生活中处理的绝大多数集合都是可测的,
因此我们在现实生活中处理的大部分函数自然也是可测的.
例如, 连续函数就是可测的.
```

- 引理 (__连续函数是可测的__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to R^m $$
  是一个连续函数. 那么
  $$ f $$
  也是可测的.

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to R^m $$
  是一个函数. 那么
  $$ f $$
  是可测的, 当且仅当对于每一个开盒子
  $$ B $$,
  $$ f^{-1} (B) $$
  都是可测的.

- 推论 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to R^m $$
  是一个函数. 如果
  $$ f = (f_1, ..., f_m) $$,
  其中
  $$ f_j: Ω \to R $$
  是
  $$ f $$
  的第
  $$ j $$
  个分量, 那么
  $$ f $$
  是可测的, 当且仅当每一个单独的
  $$ f_j $$
  都是可测的.

```
遗憾的是, 两个可测函数的复合并不一定是可测的.
不过我们还有下面这个最佳结果: 连续函数作用在可测函数上的结果是可测的.
```

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ W $$
  是
  $$ R^m $$
  的开子集. 如果
  $$ f: Ω \to W $$
  是可测的, 并且
  $$ g: W \to R^p $$
  是一个连续函数, 那么
  $$ g \circ f: Ω \to R^p $$
  是可测的.

- 推论 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集. 如果
  $$ f: Ω \to R $$
  是一个可测函数, 那么
  $$ |f| $$,
  $$ \max(f, 0) $$
  和
  $$ \min(f, 0) $$
  也都是可测的.

- 推论 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集. 如果
  $$ f: Ω \to R $$
  和
  $$ g: Ω \to R $$
  都是可测函数, 那么
  $$ f + g $$,
  $$ f - g $$,
  $$ fg $$,
  $$ \max(f, g) $$
  以及
  $$ \min(f, g) $$
  都是可测函数. 如果对于所有的
  $$ x \in Ω $$
  都有
  $$ g(x) ≠ 0 $$,
  那么
  $$ f / g $$
  也是可测的.

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to R $$
  是一个函数. 那么
  $$ f $$
  是可测的, 当且仅当对于每一个实数
  $$ a $$,
  $$ f^{-1} ((a, ∞)) $$
  都是可测的.

```
正如你所看到的, 我们对可测函数做的任何事情几乎都能构造出另一个可测函数.
这基本上就解释了为什么我们在数学中处理的每一个函数差不多都是可测的.
(实际上, 构造不可测函数的唯一方法就是人为地去构造, 比如使用选择公理.)
```

### 勒贝格积分

- 定义 (__简单函数__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to R $$
  是一个可测函数. 如果象集
  $$ f(Ω) $$
  是一个有限集, 那么我们称
  $$ f $$
  是一个`简单函数`.
  - 也就是说, 存在有限个实数
    $$ c_1 $$,
    $$ c_2 $$,
    ...,
    $$ c_N $$,
    使得对于每一个
    $$ x \in Ω $$
    都存在一个
    $$ 1 ≤ j ≤ N $$
    满足
    $$ f(x) = c_j $$.

```
我们给出简单函数的三个基本性质:
它们构成一个向量空间,
它们是特征函数的线性组合,
它们逼近可测函数.
更准确地说, 我们有如下三个引理.
```

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的一个可测子集, 并设
  $$ f: Ω \to R $$
  和
  $$ g: Ω \to R $$
  都是简单函数, 那么
  $$ f + g $$
  是一个简单函数, 另外, 对于任意的标量
  $$ c \in R $$,
  函数
  $$ cf $$
  也是一个简单函数.

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的一个可测子集, 并设
  $$ f: Ω \to R $$
  是一个简单函数. 那么存在有限多个实数
  $$ c_1 $$,
  ...,
  $$ c_N $$
  和
  $$ Ω $$
  中的有限多个互不相交的可测集
  $$ E_1 $$,
  $$ E_2 $$,
  ...,
  $$ E_N $$,
  使得
  $$ f = \sum_{i = 1}^{N} c_i χ E_i $$.

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的一个可测子集, 并设
  $$ f: Ω \to R $$
  是一个可测函数. 如果
  $$ f $$
  始终是非负的, 即对于所有的
  $$ x \in Ω $$
  都有
  $$ f(x) ≥ 0 $$,
  那么存在一个简单函数序列
  $$ f_1 $$,
  $$ f_2 $$,
  $$ f_3 $$,
  ..., 其中
  $$ f_n: Ω \to R $$,
  使得序列
  $$ f_n $$
  是非负且单调递增的,
  - $$ 0 ≤ f_1(x) ≤ f_2(x) ≤ f_3(x) ≤ ... $$,
    $$ x \in Ω $$
  - 而且该序列逐点收敛于
    $$ f $$:
  - $$ \lim_{n \to \infty} f_n(x) = f(x) $$,
    $$ x \in Ω $$

- 定义 (__简单函数的勒贝格积分__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的一个可测子集, 并设
  $$ f: Ω \to R $$
  是一个非负的简单函数, 那么
  $$ f $$
  是可测的, 象集
  $$ f(Ω) $$
  是有限集并且包含在
  $$ [0, ∞) $$
  中. 于是, 我们把
  $$ f $$
  在
  $$ Ω $$
  上的`勒贝格积分`
  $$ \int_{Ω} f $$
  定义为:
  - $$
      \int_{Ω} f := \sum_{λ \in f(Ω); λ > 0}
      λm(\{ x \in Ω: f(x) = λ \})
    $$
  - 我们有时也把
    $$ \int_{Ω} f $$
    记作
    $$ \int_{Ω} f dm $$
    (以此来强调勒贝格测度
    $$ m $$
    的作用), 或者使用一个像
    $$ x $$
    这样的虚拟变量, 比如
    $$ \int_{Ω} f(x) dx $$.

```
注意, 积分的这个定义与我们对积分 (至少非负函数的积分) 的直观概念相对应,
也就是说, 我们把积分看作函数图像下方的面积 (或高维情形下的体积).
关于非负简单函数的积分, 还有另外一种表述.
```

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ E_1 $$,
  $$ E_2 $$,
  ...,
  $$ E_N $$
  是
  $$ Ω $$
  的有限个互不相交的可测子集, 设
  $$ c_1 $$,
  ...,
  $$ c_N $$
  都是非负数 (不必两两不同), 那么有
  - $$
      \int_{Ω} \sum_{j = 1}^{N} c_j χ E_j =
      \sum_{j = 1}^{N} c_j m(E_j)
    $$

```
现在我们从非负简单函数的积分过渡到非负可测函数的积分.
有时我们允许可测函数的取值为 +∞.
```

- 定义 (__从上方控制__) 设
  $$ f: Ω \to R $$
  和
  $$ g: Ω \to R $$
  都是函数. 我们称
  $$ f $$
  从上方控制
  $$ g $$,
  或者
  $$ g $$
  从下方控制
  $$ f $$,
  当且仅当对于所有的
  $$ x \in Ω $$
  都有
  $$ f(x) ≥ g(x) $$.
  - 有时, 我们使用
    $$ f $$
    支配
    $$ g $$
    来代替
    $$ f $$
    从上方控制
    $$ g $$.

- 定义 (__非负函数的勒贝格积分__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to [0, ∞] $$
  是一个非负的可测函数. 那么, 我们把
  $$ f $$
  在
  $$ Ω $$
  上的`勒贝格积分`
  $$ \int_Ω f $$
  定义为
  - $$ \int_Ω f := \sup \{ \int_Ω s: s $$
    是一个非负简单函数, 并且
    $$ s $$
    从下方控制
    $$ f \} $$
  - 有趣的是, 在这里我们不需要让这个下积分与上积分相等.
  - 注意, 如果
    $$ Ω' $$
    是
    $$ Ω $$
    的任意一个可测子集, 那么通过把
    $$ f $$
    限制到
    $$ Ω' $$,
    我们也可以把
    $$ \int_{Ω'} f $$
    定义为
    $$ \int_{Ω'} f := \int_{Ω'} f \mid_{Ω'} $$.

- 我们必须验证这个定义与前面的非负简单函数的勒贝格积分概念是一致的.
  也就是说, 如果
  $$ f: Ω \to R $$
  是一个非负简单函数, 那么由上述定义给出的
  $$ \int_Ω f $$
  的值应当等于由之前的定义给出的
  $$ \int_Ω f $$
  的值.
  - 这一点显然成立, 因为
    $$ f $$
    一定能从下方控制它自身, 而且, 其他任意一个从下方控制
    $$ f $$
    的非负简单函数
    $$ s $$
    都满足
    $$ \int_Ω s ≤ \int_Ω f $$.
  - 注意, 由于零是从下方控制
    $$ f $$
    的非负简单函数, 因此
    $$ \int_Ω f $$
    始终不小于零. 当然,
    $$ \int_Ω f $$
    可以等于
    $$ +∞ $$.

- 命题 设
  $$ Ω $$
  是一个可测集, 并设
  $$ f: Ω \to [0, ∞] $$
  和
  $$ g: Ω \to [0, ∞] $$
  都是非负可测函数.
  - (a)
    $$ 0 ≤ \int_Ω f ≤ ∞ $$.
    另外,
    $$ \int_Ω f = 0 $$
    当且仅当
    $$ f(x) = 0 $$
    几乎对于
    $$ Ω $$
    中的每一个
    $$ x $$
    都成立.
  - (b) 对于任意的正数
    $$ c $$,
    有
    $$ \int_Ω cf = c \int_Ω f $$.
  - (c) 如果对于所有的
    $$ x \in Ω $$
    都有
    $$ f(x) ≤ g(x) $$,
    那么
    $$ \int_Ω f ≤ \int_Ω g $$.
  - (d) 如果
    $$ f(x) = g(x) $$
    几乎对于
    $$ Ω $$
    中的每一个
    $$ x $$
    都成立, 那么
    $$ \int_Ω f = \int_Ω g $$.
  - (e) 如果
    $$ Ω' \subseteq Ω $$
    是一个可测集, 那么
    $$ \int_{Ω'} f = \int_Ω f χ Ω' ≤ \iint_Ω f $$.

```
注 命题 (d) 十分有趣, 它说的是我们可以修改函数在任意测度为零的集合上的值
(例如, 你可以修改每一个有理数上的值), 而且这不会对其积分值产生任何影响.
这似乎表明任何单独的点, 即使是测度为零的点集, 都对函数积分的结果没有任何"贡献".
只有正测度的点集才会对积分产生影响.
```

```
在前几章中我们已经看到, 积分运算与极限运算
(或者类似于极限的概念, 比如上确界) 的次序并不总是可以交换的.
但是, 倘若函数序列是单调递增的,
那么勒贝格积分与极限运算的次序就是可以交换的.
```

- 定理 (__勒贝格单调收敛定理__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ (f_n)_{n = 1}^{\infty} $$
  是一个非负可测函数序列, 其中
  $$ f_i: Ω \to R $$,
  而且这个序列还是单调递增的, 即对于每一个
  $$ x \in Ω $$
  都有
  - $$ 0 ≤ f_1 (x) ≤ f_2 (x) ≤ f_3 (x) ≤ ... $$
  - (注意, 在这里我们假设
    $$ f_n (x) $$
    关于
    $$ n $$
    是单调递增的这个概念不同于
    $$ f_n (x) $$
    关于
    $$ x $$
    是单调递增的.) 于是有
  - $$ 0 ≤ \int_Ω f_1 ≤ \int_Ω f_2 ≤ \int_Ω f_3 ≤ ... $$
  - 和
  - $$ \int_Ω \sup_n f_n = \sup_n \int_Ω f_n $$

- 引理 (__交换加法运算与积分运算的次序__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to [0, ∞] $$
  和
  $$ g: Ω \to [0, ∞] $$
  都是可测函数, 那么
  $$ \int_Ω (f + g) = \int_Ω f + \int_Ω g $$.

- 推论 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ g_1 $$,
  $$ g_2 $$,
  ... 是一个非负可测函数序列, 其中
  $$ g_i: Ω \to [0, ∞] $$,
  那么有
  - $$
      \int_Ω \sum_{n = 1}^{\infty} g_n =
      \sum_{n = 1}^{\infty} \int_Ω g_n
    $$
  - 注意, 我们不必对上述和式的收敛性做出任何假设, 这个等式的两端可以同时等于
    $$ +∞ $$.
    但是, 我们绝对有必要假定函数的非负性.
- 类似地, 我们可以问能否交换极限运算与积分运算的次序.
  也就是说, 问下面这个式子是否成立
  - $$ \int_Ω \lim_{n \to \infty} f_n = \lim_{n \to \infty} \int_Ω f_n $$
  - 很遗憾, 上式并不成立, 下面的"移动颠簸"就是一个例子. 对于每一个
    $$ n = 1, 2, 3, ... $$,
    设
    $$ f_n: R \to R $$
    是函数
    $$ f_n = χ_{[n, n + 1)} $$.
    那么对于每一个
    $$ x $$
    有
    $$ \lim_{n \to \infty} f_n (x) = 0 $$,
    但对于每一个
    $$ n $$
    有
    $$ \int_R f_n = 1 $$,
    从而有
    $$ \lim_{n \to \infty} \int_R f_n = 1 ≠ 0 $$.
  - 换言之, 极限函数
    $$ \lim_{n \to \infty} f_n $$
    的积分最终会远小于任何一个初始积分. 然而,
    下面这个非常有用的法都引理表明了, 反过来的结论是不成立的,
    即极限函数的积分不可能大于初始积分 (的极限).

- 引理 (__法都引理__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f_1 $$,
  $$ f_2 $$,
  ... 是一个从
  $$ Ω $$
  到
  $$ [0, ∞] $$
  的非负函数序列. 那么有
  - $$
      \int_Ω \lim \inf_{n \to \infty} f_n ≤
      \lim \inf_{n \to \infty} \int_Ω f_n
    $$

- 注意, 我们允许函数在某些点处的取值是
  $$ +∞ $$.
  一个取值为
  $$ +∞ $$
  的函数甚至仍然可以有一个有限的积分.
  - 例如, 设
    $$ E $$
    是一个测度为零的集合, 函数
    $$ f: Ω \to R $$
    在
    $$ E $$
    上的取值等于
    $$ +∞ $$,
    但
    $$ f $$
    在其他任何地方的取值都等于零.
  - 那么,
    $$ \int_Ω f = 0 $$.
  - 但如果积分是有限的, 那么这个函数一定几乎处处有限.

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to [0, ∞] $$
  是一个非负可测函数, 而且
  $$ \int_Ω f $$
  是有限的. 那么
  $$ f $$
  几乎处处有限 (即集合
  $$ \{ x \in Ω: f(x) = +∞ \} $$
  的测度为零).

- 引理 (__Borel-Cantelli 引理__) 设
  $$ Ω_1 $$,
  $$ Ω_2 $$,
  ... 是
  $$ R^n $$
  的一列可测子集, 并且
  $$ \sum_{n = 1}^{\infty} m(Ω_n) $$
  是有限的. 那么集合
  $$ \{ x \in R^n: $$
  存在无限多个
  $$ n $$
  使得
  $$ x \in Ω_n \} $$
  的测度为零.
  - 换言之, 几乎每一个点都只属于有限多个
    $$ Ω_n $$.

```
现在我们已经介绍完了关于非负函数的勒贝格积分理论.
接下来, 我们考察如何对取值既可以是正数也可以是负数的函数求积分.
但是, 为了避免出现 +∞ + (-∞) 这种无定义的表达式,
我们将把注意力集中在一类特殊的可测函数上, 即绝对可积函数.
```

- 定义 (__绝对可积函数__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集. 对于可测函数
  $$ f: Ω \to R^{*} $$,
  如果积分
  $$ \int_Ω |f| $$
  是有限的, 那么我们称
  $$ f $$
  是`绝对可积`的.
  - 显然,
    $$ |f| $$
    总是非负的, 因此即使
    $$ f $$
    是变号的, 这个定义也有意义. 绝对可积函数也被称为
    $$ L^1 (Ω) $$
    函数.
  - 如果
    $$ f: Ω \to R^{*} $$
    是一个函数, 那么我们把它的`正部`
    $$ f^{+}: Ω \to [0, ∞] $$
    和`负部`
    $$ f^{-}: Ω \to [0, ∞] $$
    分别定义为:
  - $$ f^{+} := \max (f, 0) $$;
    $$ f^{-} := - \min (f, 0) $$
  - 可知,
    $$ f^{+} $$
    和
    $$ f^{-} $$
    都是可测的. 另外, 观察可知,
    $$ f^{+} $$
    和
    $$ f^{-} $$
    都是非负函数, 而且
    $$ f = f^{+} - f^{-} $$,
    $$ |f| = f^{+} + f^{-} $$.

- 定义 (__勒贝格积分__) 设
  $$ f: Ω \to R^{*} $$
  是一个绝对可积函数, 我们把
  $$ f $$
  的`勒贝格积分`
  $$ \int_Ω f $$
  定义为
  - $$ \int_Ω f := \int_Ω f^{+} - \int_Ω f^{-} $$
  - 注意, 因为
    $$ f $$
    是绝对可积的, 所以
    $$ \int_Ω f^{+} $$
    和
    $$ \int_Ω f^{-} $$
    都小于或者等于
    $$ \int_Ω |f| $$,
    因此它们都是有限的. 所以,
    $$ \int_Ω f $$
    总是有限的. 我们绝不会遇到不确定形式
    $$ +∞ - (+∞) $$.
  - 注意, 这个定义与前面关于非负函数的勒贝格积分定义是一致的, 因为如果
    $$ f $$
    是非负的, 那么
    $$ f^{+} = f $$
    且
    $$ f^{-} = 0 $$.
  - 此外, 我们还有下面这个有用的三角不等式
    $$ |\int_Ω f| ≤ \int_Ω f^{+} + \int_Ω f^{-} = \int_Ω |f| $$.

- 命题 设
  $$ Ω $$
  是一个可测集, 并设
  $$ f: Ω \to R $$
  和
  $$ g: Ω \to R $$
  都是绝对可积函数.
  - (a) 对于任意的实数
    $$ c $$
    (正数, 零或负数),
    $$ cf $$
    是绝对可积的, 并且
    $$ \int_Ω cf = c \int_Ω f $$.
  - (b) 函数
    $$ f + g $$
    是绝对可积的, 并且
    $$ \int_Ω (f + g) = \int_Ω f + \int_Ω g $$.
  - (c) 如果对于所有的
    $$ x \in Ω $$
    都有
    $$ f(x) ≤ g(x) $$,
    那么
    $$ \int_Ω f ≤ \int_Ω g $$.
  - (d) 如果
    $$ f(x) = g(x) $$
    几乎对于每一个
    $$ x \in Ω $$
    都成立, 那么
    $$ \int_Ω f = \int_Ω g $$.

- 我们曾提到过, 极限运算和积分运算的次序是不能随意交换的, 即
  $$ \lim \int f_n = \int \lim f_n $$
  不一定成立, 就像在"移动颠簸"的例子中所展现的那样. 但是,
  如果存在一个绝对可积的函数能够从上方控制每一个函数
  $$ f_n $$,
  那么我们就可以排除移动颠簸的例子而成功地交换极限运算和积分运算的次序.
  - 这个极其有用的重要定理被称为`勒贝格控制收敛定理`.
- 定理 (__勒贝格控制收敛定理__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f_1 $$,
  $$ f_2 $$,
  ... 是一列从
  $$ Ω $$
  到
  $$ R^{*} $$
  的可测函数, 而且这个函数序列是逐点收敛的. 如果存在一个绝对可积函数
  $$ F: Ω \to [0, ∞] $$,
  使得对于所有的
  $$ x \in Ω $$
  和所有的
  $$ n = 1, 2, 3, ... $$
  都有
  $$ |f_n (x)| ≤ F(x) $$,
  那么
  - $$ \int_Ω \lim_{n \to \infty} f_n = \lim_{n \to \infty} \int_Ω f_n $$

- 定义 (__上勒贝格积分和下勒贝格积分__) 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to R $$
  是一个函数 (不一定是可测的).
  - 我们把`上勒贝格积分`
    $$ \overline{\int}_Ω f $$
    定义为:
  - $$ \overline{\int}_Ω f := \inf \{ \int_Ω g | g: Ω \to R $$
    是从上方控制
    $$ f $$
    的绝对可积函数
    $$ \} $$
  - 并把`下勒贝格积分`
    $$ \underline{\int}_Ω f $$
    定义为:
  - $$ \underline{\int}_Ω f := \sup \{ \int_Ω g | g: Ω \to R $$
    是从下方控制
    $$ f $$
    的绝对可积函数
    $$ \} $$
  - 容易看出
    $$ \underline{\int}_Ω f ≤ \overline{\int}_Ω f $$.
    当
    $$ f $$
    绝对可积时, 等式成立. 其逆命题也成立.

- 引理 设
  $$ Ω $$
  是
  $$ R^n $$
  的可测子集, 并设
  $$ f: Ω \to R $$
  是一个函数 (不一定是可测的). 设
  $$ A $$
  是一个实数. 如果
  $$ \overline{\int}_Ω f = \underline{\int}_Ω f = A $$,
  那么
  $$ f $$
  是绝对可积的, 并且
  - $$ \int_Ω f = \overline{\int}_Ω f = \underline{\int}_Ω f = A $$

- __每一个黎曼可积的函数也是勒贝格可积的__,
  至少在有界区间上如此; __但反之不成立__.
  - 例如, 函数
    $$ f: [0, 1] \to R $$
    具有如下定义: 当
    $$ x $$
    是有理数时,
    $$ f(x) := 1 $$;
    当
    $$ x $$
    是无理数时,
    $$ f(x) := 0 $$.
    那么,
    $$ f $$
    不是黎曼可积的.
  - 另外,
    $$ f $$
    是集合
    $$ Q \cap [0, 1] $$
    的特征函数, 这里的
    $$ Q \cap [0, 1] $$
    是一个可数集, 从而其测度为
    $$ 0 $$.
    于是
    $$ f $$
    是勒贝格可积的并且
    $$ \int_{[0, 1]} f = 0 $$.

```
由此可见, 与黎曼积分相比, 勒贝格积分可以处理更多的函数.
这是我们为什么在分析学中使用勒贝格积分的主要原因之一.
另一个原因是, 勒贝格积分可以很好地与极限运算进行交互,
这一点已经在勒贝格单调收敛定理, 法都引理以及勒贝格控制收敛定理中得到证明.
但在黎曼积分中, 并不存在这样的相应定理.
```

> 相对而言, 最后两章, 略显单薄~

- [富比尼定理](https://en.wikipedia.org/wiki/Fubini's_theorem)

> 结: 2024 年 10 月
